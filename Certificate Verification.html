<!DOCTYPE html>
<html lang="en">
<head>

   <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZTSGLM0ZH"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZZTSGLM0ZH');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="MergeScholars – Free academic resources, certificates, and guides for students.">
  <meta name="keywords" content="MergeScholars, free certificates, student resources, educational tools">
  <meta name="author" content="Istiak Ahmed Mozumder">
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

<title>MergeScholars Certificate Verification</title>

<!-- Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body, html {
    height: 100%;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow: hidden;
    user-select: none;
    transition: background-color 0.5s, color 0.5s;
  }

  /* Canvas for connecting dots animation */
  #dots-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
  }

  /* Header styles */
  #header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    padding: 1rem 2rem;
    z-index: 100;
    display: flex;
    justify-content: space-between;
    align-items: center;
    backdrop-filter: blur(10px);
    background: rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  #header:hover {
    background: rgba(0, 0, 0, 0.2);
  }

  .logo {
    font-size: 1.8rem;
    font-weight: 800;
    text-decoration: none;
    color: inherit;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
  }

  .logo:hover {
    transform: scale(1.05);
    text-shadow: 0 0 10px currentColor;
  }

  .logo i {
    font-size: 1.5rem;
  }

/* THEME STYLES */

body.bonita {
  background: linear-gradient(135deg, #f4e1c1 0%, #e6c9a3 100%);
  color: #5a381e;
}
body.bonita #main {
  background: rgba(244, 225, 193, 0.92);
  border-color: #c28e47;
  box-shadow: 0 10px 30px rgba(194, 142, 71, 0.3);
}
body.bonita input[type="text"] {
  border-color: #c28e47;
  background: #fff6e8;
  color: #5a381e;
}
body.bonita input[type="text"]:focus {
  border-color: #a56b1d;
  box-shadow: 0 0 10px #a56b1d;
}
body.bonita button {
  background: linear-gradient(to right, #c28e47, #d9a663);
  color: white;
  box-shadow: 0 4px 15px rgba(194, 142, 71, 0.4);
}
body.bonita button:hover {
  box-shadow: 0 6px 20px rgba(165, 107, 29, 0.6);
  transform: translateY(-2px);
}
body.bonita #message {
  color: #5a381e;
  text-shadow: none;
}
body.bonita #flag-container {
  display: none; /* hide flag container completely */
}
body.bonita #whatsapp-btn {
  background: #25D366;
  box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
}
body.bonita .cert-box.issued {
  background: linear-gradient(135deg, #e6d5a8 0%, #d9c495 100%);
  color: #5a381e;
  border-color: #c28e47;
  box-shadow: 0 10px 20px rgba(194, 142, 71, 0.3);
}
body.bonita .cert-box.verified {
  background: linear-gradient(135deg, #d1bc75 0%, #c5ab5f 100%);
  color: #5a381e;
  border-color: #a56b1d;
  box-shadow: 0 10px 20px rgba(165, 107, 29, 0.3);
}
body.bonita #header {
  border-bottom: 1px solid rgba(194, 142, 71, 0.3);
}
body.bonita .theme-btn.active {
  background: rgba(194, 142, 71, 0.2);
  border: 1px solid #c28e47;
}

body.sunora {
  background: linear-gradient(135deg, #0a0f22 0%, #1a2342 100%);
  color: #0ff;
}
body.sunora #main {
  background: rgba(10, 15, 34, 0.92);
  border-color: #0ff;
  box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
}
body.sunora input[type="text"] {
  border-color: #0ff;
  background: #001122;
  color: #0ff;
}
body.sunora input[type="text"]:focus {
  border-color: #00ffff;
  box-shadow: 0 0 10px #00ffff;
}
body.sunora button {
  background: linear-gradient(to right, #0ff, #4deeea);
  color: black;
  box-shadow: 0 4px 15px rgba(0, 255, 255, 0.4);
}
body.sunora button:hover {
  box-shadow: 0 6px 20px rgba(0, 255, 255, 0.6);
  transform: translateY(-2px);
}
body.sunora #message {
  color: #0ff;
  text-shadow: none;
}
body.sunora #flag-container {
  display: none; /* hide flag container */
}
body.sunora #whatsapp-btn {
  background: #25D366;
  box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
}
body.sunora #header {
  border-bottom: 1px solid rgba(0, 255, 255, 0.3);
}
body.sunora .theme-btn.active {
  background: rgba(0, 255, 255, 0.2);
  border: 1px solid #0ff;
}

body.luna {
  background: linear-gradient(135deg, #fcfcfc 0%, #e6e6e6 100%);
  color: #444;
}
body.luna #main {
  background: rgba(255, 255, 255, 0.95);
  border-color: #888;
  box-shadow: 0 10px 30px rgba(136, 136, 136, 0.3);
}
body.luna input[type="text"] {
  border-color: #888;
  background: #fff;
  color: #444;
}
body.luna input[type="text"]:focus {
  border-color: #555;
  box-shadow: 0 0 10px #555;
}
body.luna button {
  background: linear-gradient(to right, #555, #777);
  color: white;
  box-shadow: 0 4px 15px rgba(85, 85, 85, 0.4);
}
body.luna button:hover {
  box-shadow: 0 6px 20px rgba(51, 51, 51, 0.6);
  transform: translateY(-2px);
}
body.luna #message {
  color: #444;
  text-shadow: none;
}
body.luna #flag-container {
  display: none; /* hide flag container */
}
body.luna #whatsapp-btn {
  background: #25D366;
  box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
}
body.luna #header {
  border-bottom: 1px solid rgba(136, 136, 136, 0.3);
}
body.luna .theme-btn.active {
  background: rgba(136, 136, 136, 0.2);
  border: 1px solid #888;
}

  #main {
    position: relative;
    z-index: 10;
    max-width: 500px;
    margin: 100px auto 40px;
    padding: 2.5rem;
    border-radius: 20px;
    border: 2px solid currentColor;
    backdrop-filter: blur(5px);
    animation: fadeInUp 0.8s ease-out;
  }

  h1 {
    margin-top: 0;
    text-align: center;
    font-weight: 800;
    font-size: 2.2rem;
    margin-bottom: 1.5rem;
    background: linear-gradient(135deg, currentColor 0%, #888 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  label {
    display: block;
    margin-bottom: 0.8rem;
    font-weight: 600;
    font-size: 1.1rem;
  }

  input[type="text"] {
    width: 100%;
    padding: 0.8rem 1.2rem;
    font-size: 1.1rem;
    border-radius: 10px;
    outline: none;
    transition: all 0.3s;
    border: 2px solid currentColor;
    background-color: transparent;
    color: inherit;
  }

  input.shake {
    animation: shake 0.4s;
  }

  @keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    50% { transform: translateX(8px); }
    75% { transform: translateX(-8px); }
    100% { transform: translateX(0); }
  }

  button {
    margin-top: 1.5rem;
    width: 100%;
    font-weight: 700;
    font-size: 1.2rem;
    padding: 0.9rem;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s;
  }

  button:hover {
    transform: translateY(-3px);
  }

  #message {
    margin-top: 1.5rem;
    min-height: 6rem;
    font-size: 1.1rem;
    white-space: pre-wrap;
    font-family: monospace;
    line-height: 1.4;
    padding: 1rem;
    border-radius: 10px;
    background: rgba(0, 0, 0, 0.05);
    transition: all 0.3s;
  }

  #action-buttons {
    margin-top: 1.5rem;
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: space-between;
  }

  #action-buttons button {
    flex: 1;
    min-width: 180px;
  }

  /* WhatsApp floating button */
  #whatsapp-btn {
    position: fixed;
    bottom: 25px;
    right: 25px;
    width: 65px;
    height: 65px;
    border-radius: 50%;
    box-shadow: 0 4px 20px rgba(37, 211, 102, 0.5);
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 30;
    transition: all 0.3s;
    background-color: #25D366;
  }

  #whatsapp-btn:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 6px 25px rgba(37, 211, 102, 0.7);
  }

  #whatsapp-btn svg {
    fill: white;
    width: 36px;
    height: 36px;
  }

  /* Theme toggle button */
  #theme-toggle-container {
    display: flex;
    gap: 0.8rem;
  }

  .theme-btn {
    padding: 0.5rem 1rem;
    font-weight: 600;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid transparent;
  }

  .theme-btn:hover {
    transform: translateY(-3px);
  }

  /* Notification toast */
  #toast {
    position: fixed;
    bottom: 100px;
    right: 25px;
    background: rgba(0,0,0,0.85);
    color: #0ff;
    padding: 1rem 1.5rem;
    border-radius: 10px;
    font-weight: 600;
    box-shadow: 0 5px 20px rgba(0, 255, 255, 0.4);
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s;
    z-index: 100;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  #toast.show {
    opacity: 1;
    transform: translateY(-10px);
  }

  /* Certificates container */
  .certificates-container {
    display: flex;
    gap: 30px;
    justify-content: center;
    margin: 40px auto;
    max-width: 90%;
    animation: fadeInUp 1s ease forwards;
    opacity: 0;
    position: relative;
    z-index: 10;
  }

  /* Boxes */
  .cert-box {
    flex: 1 1 250px;
    max-width: 300px;
    padding: 25px 20px;
    border-radius: 20px;
    text-align: center;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    transition: all 0.4s ease;
    cursor: default;
    user-select: none;
    opacity: 0.9;
    border: 2px solid transparent;
    animation: pulse 2s infinite;
  }

  .cert-box h2 {
    font-size: 1.5rem;
    margin-bottom: 15px;
    font-weight: 700;
  }

  .cert-box p {
    font-size: 2.8rem;
    font-weight: 800;
  }

  /* Animations */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(40px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.03); }
    100% { transform: scale(1); }
  }

  @keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
    100% { transform: translateY(0px); }
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    #main {
      margin: 90px 20px 30px;
      padding: 1.5rem;
    }
    
    .certificates-container {
      flex-direction: column;
      align-items: center;
    }
    
    #theme-toggle-container {
      flex-wrap: wrap;
      justify-content: center;
    }
    
    #header {
      padding: 1rem;
    }
    
    .logo {
      font-size: 1.5rem;
    }
  }
</style>
</head>
<body class="sunora">

<canvas id="dots-canvas"></canvas>

<header id="header">
  <a href="index.html" class="logo">
    <i class="fas fa-graduation-cap"></i>
    <span>MergeScholars</span>
  </a>
  <div id="theme-toggle-container" aria-label="Theme selection">
    <button type="button" class="theme-btn" data-theme="bonita" aria-pressed="false">Desert</button>
    <button type="button" class="theme-btn active" data-theme="sunora" aria-pressed="true">Neon</button>
    <button type="button" class="theme-btn" data-theme="luna" aria-pressed="false">Classic</button>
  </div>
</header>

<div id="main" role="main" aria-label="Certificate verification section">
  <h1>Certificate Verification</h1>
  <label for="cert-id">Enter your Certificate ID:</label>
  <input type="text" id="cert-id" placeholder="e.g. 2016345022" maxlength="20" autocomplete="off" aria-describedby="message" />
  <button id="verify-btn">Verify Certificate</button>
  <div id="message" aria-live="polite"></div>
  <div id="action-buttons" style="display:none;">
    <button id="download-pdf-btn" aria-label="Download Certificate PDF">Download Certificate PDF</button>
    <button id="copy-link-btn" aria-label="Copy shareable verification link">Copy Shareable Link</button>
  </div>
</div>

<div class="certificates-container">
  <div class="cert-box issued">
    <h2>Certificate Issued</h2>
    <p><span class="count" data-target="50">0</span>+</p>
  </div>
  <div class="cert-box verified">
    <h2>Certificate Verified</h2>
    <p><span class="count" data-target="20">0</span>+</p>
  </div>
</div>

<div id="whatsapp-btn" title="Contact Support via WhatsApp" role="button" aria-label="Contact Support via WhatsApp" tabindex="0">
  <svg viewBox="0 0 448 512" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
    <path d="M380.9 97.1C339-2.9 235.7-24.2 158.6 43.2c-47 45.7-50 115.9-39 175.8-43.5-13-80.7-48.6-80.8-109.1-1.1-77.2 73.6-139.1 134.5-118.3 26.6 9.3 43.5 28.6 54.8 45.7 18.3 27.8 21.9 72.6 15.6 109.7-6 33.4-32 50-47 64.2-21.3 20.2-27.9 27.9-44 35.8 17.7 5.2 38.6 6.8 58 3.5 38.4-6.6 64.2-31.8 81.7-60.8 9.7-16.7 16.8-36.4 18-57.1 0-12.6-5.8-23.4-16.1-30.6zM319.4 383c-3.9 1.6-8 3.3-12.3 5.2-19.2 8.9-32.9 14.3-47.3 22.8-20.7 12.4-45.7 29.4-66.2 40.4-29.8 15.3-56.4 23.4-83.5 12.4-15.3-6.3-29.1-23.4-34.4-39.4-6.2-19.8-4.2-43.8 2-66.3 10-38.8 40.5-67.6 81-78.6 33.9-8.7 68.8-1.7 98.3 8.5 21.9 7.2 40.4 18.9 52.9 37.2 4.7 7.6 8.8 16.5 11.2 26.1 1.3 5.2 1.9 11.1 1.7 17.5-.3 11.6-3.7 20.7-9.2 27.7-3.8 5-7.3 7.9-12.6 10z"/>
  </svg>
</div>

<div id="toast" role="alert" aria-live="assertive" aria-atomic="true"></div>

<script>
  // Certificate data
  const validCertificates = {
    "2016345022": {
      name: "Istiak Ahmed Mozumder",
      nationality: "Bangladesh",
      event: "MergeScholars Inspire Week ",
      date: "August 20, 2025",
      issuer: "MergeScholars Team"
    },
    "2016345234": {
      name: "Fabiha Kaisar Tisha",
      nationality: "Bangladesh",
      event: "Cute Pretty Girl",
      date: "August 7, 2025",
      issuer: "MergeScholars Organizer"
    },
    "2016345024": {
      name: "Zarin Tasnim",
      nationality: "Bangladesh",
      event: "Quantum Mechanics Webinar",
      date: "July 27, 2025",
      issuer: "MergeScholars Team"
    },
    "2016345025": {
      name: "Md. Arif Hossain",
      nationality: "Bangladesh",
      event: "Intro to Astrophysics",
      date: "July 30, 2025",
      issuer: "MergeScholars Team"
    }
  };

  // DOM elements
  const certInput = document.getElementById('cert-id');
  const verifyBtn = document.getElementById('verify-btn');
  const messageDiv = document.getElementById('message');
  const downloadPdfBtn = document.getElementById('download-pdf-btn');
  const copyLinkBtn = document.getElementById('copy-link-btn');
  const actionButtonsDiv = document.getElementById('action-buttons');
  const toast = document.getElementById('toast');
  const whatsappBtn = document.getElementById('whatsapp-btn');
  const dotsCanvas = document.getElementById('dots-canvas');
  const themeButtons = document.querySelectorAll('.theme-btn');

  let currentCert = null;

  // Dot pattern animation
  function initDotsAnimation() {
    const canvas = dotsCanvas;
    const ctx = canvas.getContext('2d');
    let width = window.innerWidth;
    let height = window.innerHeight;
    
    canvas.width = width;
    canvas.height = height;
    
    const dots = [];
    const dotCount = 80;
    const connectionDistance = 150;
    
    // Create dots
    for (let i = 0; i < dotCount; i++) {
      dots.push({
        x: Math.random() * width,
        y: Math.random() * height,
        vx: (Math.random() - 0.5) * 0.5,
        vy: (Math.random() - 0.5) * 0.5,
        radius: Math.random() * 2 + 1
      });
    }
    
    function draw() {
      ctx.clearRect(0, 0, width, height);
      
      // Get current theme color
      let dotColor, lineColor;
      if (document.body.classList.contains('bonita')) {
        dotColor = '194, 142, 71';
        lineColor = '194, 142, 71';
      } else if (document.body.classList.contains('sunora')) {
        dotColor = '0, 255, 255';
        lineColor = '0, 255, 255';
      } else {
        dotColor = '136, 136, 136';
        lineColor = '136, 136, 136';
      }
      
      // Draw and update dots
      for (let i = 0; i < dots.length; i++) {
        const dot = dots[i];
        
        // Draw dot
        ctx.beginPath();
        ctx.arc(dot.x, dot.y, dot.radius, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(${dotColor}, 0.8)`;
        ctx.fill();
        
        // Update position
        dot.x += dot.vx;
        dot.y += dot.vy;
        
        // Bounce off walls
        if (dot.x < 0 || dot.x > width) dot.vx *= -1;
        if (dot.y < 0 || dot.y > height) dot.vy *= -1;
        
        // Draw connections
        for (let j = i + 1; j < dots.length; j++) {
          const otherDot = dots[j];
          const dx = dot.x - otherDot.x;
          const dy = dot.y - otherDot.y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          
          if (dist < connectionDistance) {
            ctx.beginPath();
            ctx.strokeStyle = `rgba(${lineColor}, ${1 - dist/connectionDistance})`;
            ctx.lineWidth = 0.5;
            ctx.moveTo(dot.x, dot.y);
            ctx.lineTo(otherDot.x, otherDot.y);
            ctx.stroke();
          }
        }
      }
      
      requestAnimationFrame(draw);
    }
    
    draw();
    
    // Handle window resize
    window.addEventListener('resize', function() {
      width = window.innerWidth;
      height = window.innerHeight;
      canvas.width = width;
      canvas.height = height;
    });
  }

  // Typing effect helper
  async function typeText(element, text) {
    element.textContent = "";
    const totalDuration = 2000;
    const delay = totalDuration / text.length;
    for (const char of text) {
      element.textContent += char;
      await new Promise(r => setTimeout(r, delay));
    }
  }

  function showToast(msg) {
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
  }

  // Verification logic
  async function verifyCertificate() {
    const id = certInput.value.trim().toUpperCase();
    if (id.length < 10) {
      certInput.classList.add('shake');
      messageDiv.style.color = '';
      messageDiv.style.textShadow = '';
      messageDiv.textContent = "Certificate ID must be at least 10 characters.";
      setTimeout(() => certInput.classList.remove('shake'), 400);
      actionButtonsDiv.style.display = 'none';
      currentCert = null;
      return;
    }
    if (!(id in validCertificates)) {
      messageDiv.style.color = '#ff0066';
      messageDiv.style.textShadow = '0 0 10px #ff3399';
      await typeText(messageDiv, "Invalid Certificate ID.\nPlease contact support via WhatsApp.");
      actionButtonsDiv.style.display = 'none';
      currentCert = null;
      return;
    }

    // Valid certificate found
    currentCert = validCertificates[id];
    messageDiv.style.color = '';
    messageDiv.style.textShadow = '';
    const infoText =
      `Certificate Verified!\n\n` +
      `Name: ${currentCert.name}\n` +
      `Event: ${currentCert.event}\n` +
      `Date: ${currentCert.date}\n` +
       `Nationality: ${currentCert.nationality}\n` +
      `Certificate ID: ${id}`;

    await typeText(messageDiv, infoText);
    actionButtonsDiv.style.display = 'flex';
  }

  verifyBtn.addEventListener('click', verifyCertificate);
  certInput.addEventListener('keydown', e => {
    if(e.key === 'Enter') {
      verifyCertificate();
    }
  });

  // PDF generation
  downloadPdfBtn.addEventListener('click', () => {
    if (!currentCert) return;

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({
      unit: 'pt',
      format: 'a4',
    });

    const pageWidth = doc.internal.pageSize.getWidth();
    const pageHeight = doc.internal.pageSize.getHeight();
    const margin = 50;
    const usableWidth = pageWidth - margin * 2;

    // White background
    doc.setFillColor(255, 255, 255);
    doc.rect(0, 0, pageWidth, pageHeight, 'F');

    // Border
    doc.setDrawColor(0, 51, 102);
    doc.setLineWidth(1.5);
    doc.rect(margin/2, margin/2, pageWidth - margin, pageHeight - margin);

    // Title: MergeScholars top-left
    doc.setFont('Lora', 'bold');
    doc.setFontSize(25);
    doc.setTextColor(0, 51, 102);
    doc.text('MergeScholars', margin, margin + 25);

    // Subtitle
    doc.setFontSize(14);
    doc.setFont('Cormorant Garamond');
    doc.setTextColor(70, 70, 70);
    doc.text('Certificate Verification Test Copy', margin, margin + 50);

    // Main content text
    doc.setFont('times', 'normal');
    doc.setFontSize(14);
    doc.setTextColor(0);
    const mainText = 
      `This is to formally verify that ${currentCert.name} has been awarded an official certificate for his/her exceptional participation in the academic and creative event titled "${currentCert.event}" hosted by MergeScholars on ${currentCert.date}.\n\n` +
      `Throughout the event, ${currentCert.name} demonstrated a high level of enthusiasm, creativity, and engagement.
      His/Her contributions stood out not only for their quality 
      but also for the sincerity and dedication with which she approached each activity. 
      Participants like her reflect the mission of MergeScholars — to empower students 
      through collaboration, curiosity, and global academic exchange.
      
      We were truly impressed by ${currentCert.name}’s commitment to the event 
      and her willingness to contribute positively to the learning environment. 
      It is our belief that they possesses the potential to excel further
      and contribute meaningfully to both academic and extracurricular 
      platforms in the future.\n\n` +
      `Certificate ID: ${certInput.value.trim().toUpperCase()}\n\n` +
      `Country: ${currentCert.nationality}\n\n` +
      `Issued by: MergeScholars Certificate Verification Team
    Issued on: ${currentCert.date}\n\n` +
      `Note:
    This document is a verified confirmation copy and not the original certificate. 
      It has been issued by the MergeScholars Verification Team solely 
      for validation purposes.

      For further authentication or to verify this certificate independently,
      please visit:
       https://mergescholars.vercel.app/Certificate%20Verification.html
      and enter the Certificate ID provided above in the verification section.`;

    const splitText = doc.splitTextToSize(mainText, usableWidth);
    doc.text(splitText, margin, margin + 90);

    // Signature - bottom right corner
    const sigX = pageWidth - margin - 160;
    const sigY = pageHeight - margin - 60;

    doc.setFont('Indie Flower', 'italic');
    doc.setFontSize(30);
    doc.setTextColor(30, 30, 80);
    doc.text('Istiak', sigX, sigY);

    doc.setFont('times', 'normal');
    doc.setFontSize(12);
    doc.setTextColor(0);
    doc.text('Istiak Ahmed Mozumder', sigX, sigY + 20);
    doc.text('Founder, MergeScholars', sigX, sigY + 36);

    // Save file with clean filename
    doc.save(`MergeScholars_Verification_${currentCert.name.replace(/\s+/g, '_')}.pdf`);
  });

  // Copy shareable link
  copyLinkBtn.addEventListener('click', () => {
    if (!currentCert) return;
    const baseUrl = window.location.origin + window.location.pathname;
    const certIdParam = encodeURIComponent(certInput.value.trim().toUpperCase());
    const shareUrl = `${baseUrl}?cert=${certIdParam}`;
    navigator.clipboard.writeText(shareUrl).then(() => {
      showToast('Shareable link copied to clipboard!');
    });
  });

  // Auto-verify if URL has cert param
  window.addEventListener('load', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const certParam = urlParams.get('cert');
    if (certParam) {
      certInput.value = certParam.toUpperCase();
      verifyCertificate();
    }
  });

  // WhatsApp support button
  whatsappBtn.addEventListener('click', () => {
    const idText = certInput.value.trim() || '';
    const msg = encodeURIComponent(`Hello MergeScholars! I need help verifying my certificate. My certificate ID is ${idText}`);
    const url = `https://wa.me/8801577256859?text=${msg}`;
    window.open(url, '_blank');
  });

  // THEME TOGGLE LOGIC
  function setTheme(themeName) {
    document.body.classList.remove('bonita', 'sunora', 'luna');
    document.body.classList.add(themeName);

    // Update active button state
    themeButtons.forEach(btn => {
      if (btn.dataset.theme === themeName) {
        btn.classList.add('active');
        btn.setAttribute('aria-pressed', 'true');
      } else {
        btn.classList.remove('active');
        btn.setAttribute('aria-pressed', 'false');
      }
    });

    showToast(`Theme changed to ${themeName.replace(/^\w/, c => c.toUpperCase())}`);
    initDotsAnimation(); // Reinitialize dots with new colors
  }

  themeButtons.forEach(button => {
    button.addEventListener('click', () => {
      setTheme(button.dataset.theme);
    });
  });

  // Animate numbers in certificate boxes
  function animateCounters() {
    const counters = document.querySelectorAll('.count');
    counters.forEach(counter => {
      const target = +counter.getAttribute('data-target');
      const duration = 3500;
      let start = 0;
      const stepTime = Math.abs(Math.floor(duration / target));

      const increment = () => {
        start += 1;
        counter.textContent = start;
        if (start < target) {
          setTimeout(increment, stepTime);
        } else {
          counter.textContent = target;
        }
      };

      increment();
    });
  }

  // Initialize everything when page loads
  window.addEventListener('load', () => {
    initDotsAnimation();
    animateCounters();
    
    // Make certificate boxes float
    const certBoxes = document.querySelectorAll('.cert-box');
    certBoxes.forEach((box, index) => {
      box.style.animationDelay = `${index * 0.3}s`;
      box.style.animation = 'fadeInUp 1s ease forwards, float 4s ease-in-out infinite';
    });
  });
</script>

</body>
</html>
