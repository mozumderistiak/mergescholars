<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Join MergeScholars - Animated Form</title>
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      transition: background-color 0.5s, color 0.5s;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      background-image: radial-gradient(circle at top left, var(--pattern-light) 1px, transparent 1px), radial-gradient(circle at bottom right, var(--pattern-light) 1px, transparent 1px);
      background-size: 40px 40px;
      background-repeat: repeat;
    }
    a {
      color: var(--link);
      text-decoration: none;
      transition: color 0.3s;
    }
    a:hover {
      text-decoration: underline;
    }

    /* Theme vars */
    :root {
      --bg: #f9f9f9;
      --text: #222;
      --link: #0056b3;
      --box-bg: #fff;
      --input-bg: #fff;
      --input-text: #222;
      --border: #ccc;
      --menu-bg: rgba(255 255 255 / 0.9);
      --menu-text: #222;
      --glass-bg: rgba(255 255 255 / 0.85);
      --pattern-light: #e6e6e6;
    }
    .theme-dark {
      --bg: #121212;
      --text: #eee;
      --link: #80b3ff;
      --box-bg: #1e1e1e;
      --input-bg: #2b2b2b;
      --input-text: #eee;
      --border: #555;
      --menu-bg: rgba(30 30 30 / 0.95);
      --menu-text: #eee;
      --glass-bg: rgba(30 30 30 / 0.9);
      --pattern-light: #444444;
    }
    .theme-dessert {
      --bg: #fff1e6;
      --text: #4a3c31;
      --link: #b35c00;
      --box-bg: #fffbf5;
      --input-bg: #fff7ed;
      --input-text: #4a3c31;
      --border: #d4b996;
      --menu-bg: rgba(255 251 245 / 0.95);
      --menu-text: #4a3c31;
      --glass-bg: rgba(255 251 245 / 0.9);
      --pattern-light: #d6c3b1;
    }

    /* Header */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      background-color: var(--box-bg);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 3px 6px rgb(0 0 0 / 0.1);
      animation: slideInDown 0.7s ease forwards;
    }
    header .logo {
      font-weight: 700;
      font-size: 1.5rem;
      cursor: pointer;
      user-select: none;
      color: var(--link);
      letter-spacing: 1.1px;
      transition: color 0.3s;
    }
    header .logo:hover, header .logo:focus {
      color: var(--link);
      text-shadow: 0 0 8px var(--link);
      outline: none;
    }

    /* Menu button */
    .menu-container {
      position: relative;
    }
    .menu-btn {
      background-color: var(--box-bg);
      border: 1.8px solid var(--border);
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      color: var(--menu-text);
      user-select: none;
      font-size: 1rem;
      transition: all 0.3s ease;
      box-shadow: 0 0 8px transparent;
    }
    .menu-btn:hover, .menu-btn:focus {
      box-shadow: 0 0 12px var(--link);
      outline: none;
      border-color: var(--link);
      color: var(--link);
    }

    /* Glass overlay menu */
    .glass-menu-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: var(--glass-bg);
      display: none;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(12px);
      z-index: 999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s ease;
      user-select: none;
    }
    .glass-menu-overlay.show {
      display: flex;
      opacity: 1;
      pointer-events: auto;
    }
    .glass-menu-content {
      background-color: var(--box-bg);
      border-radius: 20px;
      box-shadow: 0 0 25px rgba(0,0,0,0.25);
      padding: 40px 50px;
      min-width: 240px;
      max-width: 90vw;
      text-align: center;
      transform: scale(0.85);
      animation: scaleIn 0.4s forwards;
      user-select: auto;
    }
    .glass-menu-content a {
      display: block;
      margin: 16px 0;
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--menu-text);
      text-shadow: 0 0 4px transparent;
      transition: color 0.3s, text-shadow 0.3s;
    }
    .glass-menu-content a:hover,
    .glass-menu-content a:focus {
      color: var(--link);
      text-shadow: 0 0 10px var(--link);
      outline: none;
    }
    .theme-selector {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 24px;
      user-select: none;
    }
    .theme-selector label {
      cursor: pointer;
      font-weight: 700;
      color: var(--menu-text);
      font-size: 1rem;
      user-select: none;
      transition: color 0.3s;
    }
    .theme-selector label:hover,
    .theme-selector label:focus-within {
      color: var(--link);
      outline: none;
    }
    .theme-selector input {
      margin-right: 8px;
      cursor: pointer;
    }

    /* Main container */
    main {
      flex-grow: 1;
      max-width: 720px;
      margin: 40px auto 60px;
      padding: 32px 30px;
      background-color: var(--box-bg);
      border-radius: 20px;
      box-shadow:
        0 10px 15px rgb(0 0 0 / 0.07),
        inset 0 0 20px rgb(0 0 0 / 0.02);
      animation: fadeInUp 0.7s ease forwards;
    }
    h1 {
      margin-top: 0;
      font-weight: 900;
      font-size: 2.5rem;
      color: var(--text);
      letter-spacing: 1.2px;
      text-align: center;
      margin-bottom: 6px;
      user-select: none;
    }
    h2 {
      font-weight: 600;
      font-size: 1.2rem;
      color: var(--text);
      margin-bottom: 2rem;
      text-align: center;
      font-style: italic;
      user-select: none;
    }

    /* Form */
    form {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    label {
      font-weight: 700;
      color: var(--text);
      user-select: none;
      display: block;
      margin-bottom: 6px;
      letter-spacing: 0.02em;
      transition: color 0.25s;
    }
    input[type=text],
    input[type=email],
    input[type=tel],
    select,
    textarea {
      width: 100%;
      padding: 12px 16px;
      border-radius: 10px;
      border: 2px solid var(--border);
      background-color: var(--input-bg);
      color: var(--input-text);
      font-size: 1.1rem;
      font-weight: 500;
      transition:
        border-color 0.3s ease,
        box-shadow 0.3s ease,
        background-color 0.3s;
      box-shadow: inset 0 0 5px rgb(0 0 0 / 0.04);
      resize: vertical;
      user-select: text;
      font-family: inherit;
    }
    input[type=text]:focus,
    input[type=email]:focus,
    input[type=tel]:focus,
    select:focus,
    textarea:focus {
      border-color: var(--link);
      outline: none;
      box-shadow: 0 0 14px var(--link);
      background-color: var(--input-bg);
    }

    /* Roles container */
    .roles-container {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
    }
    .role-item {
      flex: 1 1 45%;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      cursor: pointer;
      user-select: none;
      position: relative;
      padding-left: 28px;
    }
    .role-item input[type=checkbox] {
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: var(--link);
      border-radius: 4px;
    }
    .role-item input[type=checkbox]:focus-visible {
      outline: 2px solid var(--link);
      outline-offset: 2px;
    }

    /* Add skills box */
    .add-skills-box {
      margin-top: 8px;
      display: none;
      animation: fadeIn 0.5s ease forwards;
    }
    .add-skills-box textarea {
      font-family: inherit;
      font-weight: 500;
      line-height: 1.4;
    }

    /* Terms checkbox */
    .terms-container {
      margin-top: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      user-select: none;
    }
    .terms-container input[type=checkbox] {
      width: 22px;
      height: 22px;
      cursor: pointer;
      accent-color: var(--link);
      border-radius: 6px;
      flex-shrink: 0;
    }
    .terms-link {
      color: var(--link);
      cursor: pointer;
      font-weight: 700;
      text-decoration: underline;
      user-select: none;
      transition: color 0.3s;
    }
    .terms-link:hover, .terms-link:focus {
      color: #004494;
      outline: none;
    }

    /* Submit */
    button.submit-btn {
      margin-top: 28px;
      padding: 16px 0;
      font-weight: 900;
      font-size: 1.3rem;
      border-radius: 14px;
      background: linear-gradient(135deg, #0066ff, #0044aa);
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.25s ease;
      box-shadow: 0 6px 15px rgb(0 68 170 / 0.45);
      user-select: none;
    }
    button.submit-btn:hover:not(:disabled),
    button.submit-btn:focus:not(:disabled) {
      background: linear-gradient(135deg, #0055dd, #003d8a);
      transform: translateY(-3px);
      outline: none;
      box-shadow: 0 8px 18px rgb(0 68 170 / 0.65);
    }
    button.submit-btn:active:not(:disabled) {
      transform: translateY(1px);
      box-shadow: 0 3px 8px rgb(0 68 170 / 0.55);
    }
    button.submit-btn:disabled {
      background-color: #9ec1ff;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    /* Thank you message */
    .thank-you-message {
      margin-top: 30px;
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--link);
      text-align: center;
      user-select: none;
    }

    /* Download button */
    button#downloadBtn {
      margin: 16px auto 0;
      display: none;
      background: linear-gradient(135deg, #009933, #006622);
      color: white;
      border: none;
      padding: 14px 30px;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.25s ease;
      user-select: none;
    }
    button#downloadBtn:hover, button#downloadBtn:focus {
      background: linear-gradient(135deg, #007f29, #004d14);
      outline: none;
      transform: translateY(-3px);
    }
    button#downloadBtn:active {
      transform: translateY(1px);
    }

    /* Terms modal */
    .terms-modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.55);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1100;
      animation: fadeIn 0.35s ease forwards;
    }
    .terms-modal-overlay.show {
      display: flex;
    }
    .terms-modal {
      background-color: var(--box-bg);
      color: var(--text);
      border-radius: 18px;
      max-width: 600px;
      width: 90%;
      max-height: 75vh;
      overflow-y: auto;
      padding: 32px 36px;
      box-shadow:
        0 0 40px rgba(0,0,0,0.3),
        inset 0 0 30px rgba(0,0,0,0.05);
      position: relative;
      animation: scaleIn 0.35s ease forwards;
      user-select: text;
      font-size: 1rem;
      line-height: 1.5;
    }
    .terms-modal h3 {
      margin-top: 0;
      margin-bottom: 20px;
      font-weight: 900;
      font-size: 1.6rem;
      letter-spacing: 0.03em;
      user-select: none;
    }
    .terms-modal p {
      margin-bottom: 1rem;
    }
    .terms-close-btn {
      position: absolute;
      top: 12px;
      right: 18px;
      background: none;
      border: none;
      font-size: 2.4rem;
      font-weight: 900;
      cursor: pointer;
      color: var(--text);
      transition: color 0.3s;
      user-select: none;
    }
    .terms-close-btn:hover,
    .terms-close-btn:focus {
      color: var(--link);
      outline: none;
    }

    /* Animations */
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    @keyframes slideDown {
      from {transform: translateY(-40px); opacity: 0;}
      to {transform: translateY(0); opacity: 1;}
    }
    @keyframes slideInDown {
      from {transform: translateY(-80px); opacity: 0;}
      to {transform: translateY(0); opacity: 1;}
    }
    @keyframes fadeInUp {
      from {opacity: 0; transform: translateY(20px);}
      to {opacity: 1; transform: translateY(0);}
    }
    @keyframes scaleIn {
      from {opacity: 0; transform: scale(0.8);}
      to {opacity: 1; transform: scale(1);}
    }

    /* Responsive device detection alignment */
    @media (max-width: 720px) {
      main {
        margin: 30px 15px 50px;
        padding: 20px 16px;
      }
      .roles-container {
        flex-direction: column;
      }
      .role-item {
        flex: 1 1 100%;
      }
    }

    /* Floating WhatsApp button */
    .whatsapp-float {
      position: fixed;
      bottom: 25px;
      right: 25px;
      background-color: #25D366;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      box-shadow: 0 6px 12px rgba(0,0,0,0.25);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      animation: pulse 2.8s infinite ease-in-out;
      z-index: 1101;
      transition: box-shadow 0.3s ease;
      user-select: none;
    }
    .whatsapp-float:hover,
    .whatsapp-float:focus {
      box-shadow: 0 10px 18px rgba(37, 211, 102, 0.8);
      outline: none;
    }
    .whatsapp-float svg {
      width: 32px;
      height: 32px;
      fill: white;
      user-select: none;
      pointer-events: none;
    }
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
        box-shadow: 0 6px 12px rgba(0,0,0,0.25);
      }
      50% {
        transform: scale(1.08);
        box-shadow: 0 10px 18px rgba(37, 211, 102, 0.7);
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo" tabindex="0" role="link" aria-label="Go to MergeScholars homepage">MergeScholars</div>
    <div class="menu-container">
      <button id="menuBtn" class="menu-btn" aria-haspopup="true" aria-expanded="false" aria-controls="glassMenu" aria-label="Open menu">Menu</button>
    </div>
  </header>

  <div id="glassMenu" class="glass-menu-overlay" aria-hidden="true" role="dialog" aria-modal="true" tabindex="-1">
    <div class="glass-menu-content" role="menu" aria-label="Site menu">
      <a href="index.html" role="menuitem" tabindex="0">Home</a>
      <a href="Articles.html" role="menuitem" tabindex="0">Articles</a>
      <a href="Scholars Talk.html" role="menuitem" tabindex="0">Scholars Talk</a>
      <a href="Explore Subjects.html" role="menuitem" tabindex="0">Explore Subjects</a>
      <a href="Certificate Verification.html" role="menuitem" tabindex="0">Verify Certificates</a>
      <a href="About us.html" role="menuitem" tabindex="0">About Us</a>
      <a href="Contact us.html" role="menuitem" tabindex="0">Contact Us</a>
      <div class="theme-selector" role="group" aria-label="Select theme">
        <label><input type="radio" name="theme" value="light" /> Light</label>
        <label><input type="radio" name="theme" value="dark" /> Dark</label>
        <label><input type="radio" name="theme" value="dessert" /> Dessert</label>
      </div>
    </div>
  </div>

  <main>
    <h1>Join MergeScholars</h1>
    <h2>Apply now to be part of the MergeScholars community.</h2>

   <form id="joinForm" action="https://api.web3forms.com/submit" method="POST" novalidate style="position: relative;">
  <!-- Web3Forms hidden inputs -->
  <input type="hidden" name="access_key" value="80f59af2-a4d5-4a21-b99b-5a6471185082" />
  <input type="hidden" name="redirect" value="thankyou.html" />

  <label for="fullName">Full Name *</label>
  <input type="text" id="fullName" name="fullName" autocomplete="name" required placeholder="Your full name" />

      <label for="email">Email Address *</label>
      <input type="email" id="email" name="email" autocomplete="email" required placeholder="your.email@example.com" />

      <label for="phone">Phone Number *</label>
      <input type="tel" id="phone" name="phone" autocomplete="tel" required placeholder="+[Country Code]..." pattern="^\+?[0-9]{7,15}$" title="Enter a valid phone number with country code (e.g., +1..., +44..., +880...)" />

      <label for="country">Country of Residence *</label>
      <input type="text" id="country" name="country" required placeholder="Your country" autocomplete="country-name" />

      <label for="grade">Grade/Class *</label>
      <input type="text" id="grade" name="grade" required placeholder="e.g., 10th grade, Year 12" />

      <label for="institution">Institution Name *</label>
      <input type="text" id="institution" name="institution" required placeholder="Your school or institution" />

      <fieldset>
        <legend><strong>Role(s) you want to apply for *</strong></legend>
        <div class="roles-container" role="group" aria-label="Select one or more roles">
          <label class="role-item" for="roleStudent"><input type="checkbox" name="roles" id="roleStudent" value="Student" />Student</label>
          <label class="role-item" for="roleVolunteer"><input type="checkbox" name="roles" id="roleVolunteer" value="Volunteer" />Volunteer</label>
          <label class="role-item" for="roleContributor"><input type="checkbox" name="roles" id="roleContributor" value="Contributor" />Contributor</label>
          <label class="role-item" for="rolePromoter"><input type="checkbox" name="roles" id="rolePromoter" value="Promoter" />Promoter</label>
        </div>
      </fieldset>

      <div class="add-skills-box" id="addSkillsBox">
        <label for="skills">Add your skills (for Volunteer, Contributor, Promoter)</label>
        <textarea id="skills" name="skills" rows="3" placeholder="List your skills relevant to the roles"></textarea>
      </div>

      <label for="heardFrom">How did you hear about MergeScholars? *</label>
      <select id="heardFrom" name="heardFrom" required>
        <option value="" disabled selected>Select an option</option>
        <option value="Social Media">Social Media</option>
        <option value="Friends or Family">Friends or Family</option>
        <option value="School or Institution">School or Institution</option>
        <option value="Online Search">Online Search</option>
        <option value="Event or Seminar">Event or Seminar</option>
        <option value="Other">Other</option>
      </select>

      <div class="terms-container">
        <input type="checkbox" id="termsCheck" required />
        <label for="termsCheck">I have read all <span id="showTerms" tabindex="0" role="button" class="terms-link">Terms and Conditions</span></label>
      </div>

      <button type="submit" id="submitBtn" class="submit-btn" disabled>Submit Application</button>
    </form>

    <div id="thankYouMsg" class="thank-you-message" style="display:none;">
      Thanks for your submission!
    </div>
    <button id="downloadBtn" aria-label="Download application form as PDF">Download Application Form (PDF)</button>
  </main>

  <!-- Terms Modal -->
  <div id="termsModal" class="terms-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="termsTitle" tabindex="-1">
    <div class="terms-modal">
      <button aria-label="Close terms and conditions" class="terms-close-btn">&times;</button>
      <h3 id="termsTitle">Terms and Conditions</h3>
      <p>Welcome to MergeScholars! By submitting this application, you agree to abide by our community guidelines and policies.</p>
<p>All information you provide in this form must be accurate, truthful, and verifiable. If any false or misleading information is found, MergeScholars reserves the right to take appropriate actions, including rejection or removal from the program.</p>
<p>Members are expected to maintain honesty, integrity, and respect in all academic and community activities associated with MergeScholars.</p>
<p>We reserve the right to revoke membership or privileges if a participant engages in misconduct, provides fraudulent information, or violates our policies.</p>
<p>By joining, you also agree to allow MergeScholars to use your submitted information for verification, academic purposes, and community development while ensuring your privacy and confidentiality are respected.</p>
<p>These terms may be updated at any time, and continued participation implies acceptance of the latest version.</p>
    </div>
  </div>

  <!-- Floating WhatsApp button -->
  <a href="https://wa.me/8801577256859" target="_blank" class="whatsapp-float" aria-label="Contact on WhatsApp">
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M20.52 3.48A11.82 11.82 0 0 0 3.48 20.52l1.99-5.85L3.48 15.6a11.83 11.83 0 0 0 14.12-14.12zm-7.97 15.67a8.84 8.84 0 0 1-4.49-1.28l-.32-.19-3.11 1.06 1.04-3.06-.21-.33a8.92 8.92 0 1 1 6.99 3.8zm4.96-4.48c-.08-.14-.2-.22-.71-.43-.31-.01-.65-.02-.99-.02-.35 0-.73.14-1.13.42a4.98 4.98 0 0 1-2.48.73 3.46 3.46 0 0 1-1.83-.58 1.54 1.54 0 0 1-.59-1.14c-.01-.32-.01-.63 0-.95a.57.57 0 0 1 .18-.43l.39-.45c.05-.06.09-.09.12-.11l.02-.01c.01 0 .03 0 .06.02a1.33 1.33 0 0 1 .36.29c.13.15.29.39.46.72.06.12.12.18.16.22l.02.02c.02.03.06.04.11.04.05 0 .1-.02.16-.07l.01-.01c.1-.1.16-.18.22-.27.09-.13.13-.29.17-.46.01-.02.01-.05.02-.07l.01-.02a.55.55 0 0 0-.11-.59l-.1-.11a3.46 3.46 0 0 0-1.04-1.01 3.93 3.93 0 0 0-1.78-.66 4.25 4.25 0 0 0-1.57.17 5.75 5.75 0 0 0-1.61 1.02l-.06.06-.01.01a.58.58 0 0 0-.2.53c.01.35.01.69.03 1.03.01.15.01.31.02.46a6.36 6.36 0 0 0 1.78 3.81 6.59 6.59 0 0 0 4.37 1.95 6.22 6.22 0 0 0 4.82-2.43 6.19 6.19 0 0 0 .79-4.18z"/></svg>
  </a>

  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script>
    (() => {
      const { jsPDF } = window.jspdf;

      const body = document.body;
      const logo = document.querySelector('.logo');
      const menuBtn = document.getElementById('menuBtn');
      const glassMenu = document.getElementById('glassMenu');
      const themeRadios = document.querySelectorAll('input[name="theme"]');
      const joinForm = document.getElementById('joinForm');
      const addSkillsBox = document.getElementById('addSkillsBox');
      const rolesCheckboxes = joinForm.querySelectorAll('input[name="roles"]');
      const termsCheck = document.getElementById('termsCheck');
      const submitBtn = document.getElementById('submitBtn');
      const thankYouMsg = document.getElementById('thankYouMsg');
      const downloadBtn = document.getElementById('downloadBtn');
      const showTerms = document.getElementById('showTerms');
      const termsModal = document.getElementById('termsModal');
      const termsCloseBtn = termsModal.querySelector('.terms-close-btn');

      // Navigation logo click
      logo.addEventListener('click', () => {
        window.location.href = 'index.html';
      });
      logo.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          window.location.href = 'index.html';
        }
      });

      // Menu toggle
      menuBtn.addEventListener('click', () => {
        const isExpanded = menuBtn.getAttribute('aria-expanded') === 'true';
        if (isExpanded) {
          closeMenu();
        } else {
          openMenu();
        }
      });
      // Close menu on outside click or Escape key
      glassMenu.addEventListener('click', e => {
        if (e.target === glassMenu) closeMenu();
      });
      document.addEventListener('keydown', e => {
        if (e.key === 'Escape' && glassMenu.classList.contains('show')) closeMenu();
      });
      function openMenu() {
        glassMenu.classList.add('show');
        glassMenu.setAttribute('aria-hidden', 'false');
        menuBtn.setAttribute('aria-expanded', 'true');
        glassMenu.querySelector('a').focus();
      }
      function closeMenu() {
        glassMenu.classList.remove('show');
        glassMenu.setAttribute('aria-hidden', 'true');
        menuBtn.setAttribute('aria-expanded', 'false');
        menuBtn.focus();
      }

      // Theme switching
      function applyTheme(theme) {
        body.classList.remove('theme-light', 'theme-dark', 'theme-dessert');
        if (theme === 'dark') body.classList.add('theme-dark');
        else if (theme === 'dessert') body.classList.add('theme-dessert');
        else body.classList.add('theme-light');
        localStorage.setItem('mergescholars-theme', theme);
      }
      const savedTheme = localStorage.getItem('mergescholars-theme') || 'light';
      applyTheme(savedTheme);
      themeRadios.forEach(radio => {
        if (radio.value === savedTheme) radio.checked = true;
        radio.addEventListener('change', () => {
          applyTheme(radio.value);
        });
      });

      // Roles selection logic
      function updateSkillsBox() {
        const show = Array.from(rolesCheckboxes).some(cb =>
          ['Volunteer', 'Contributor', 'Promoter'].includes(cb.value) && cb.checked
        );
        if(show) {
          addSkillsBox.style.display = 'block';
          addSkillsBox.animate([{opacity: 0, transform: 'translateY(-10px)'},{opacity:1, transform:'translateY(0)'}], {duration: 400, fill: 'forwards'});
        } else {
          addSkillsBox.animate([{opacity: 1, transform: 'translateY(0)'},{opacity:0, transform:'translateY(-10px)'}], {duration: 300, fill: 'forwards'})
          .onfinish = () => { addSkillsBox.style.display = 'none'; addSkillsBox.querySelector('textarea').value = '';}
        }
      }
      rolesCheckboxes.forEach(cb => {
        cb.addEventListener('change', () => {
          updateSkillsBox();
          validateForm();
        });
      });

      // Terms modal open/close with animations
      showTerms.addEventListener('click', openTermsModal);
      showTerms.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openTermsModal();
        }
      });
      function openTermsModal() {
        termsModal.classList.add('show');
        termsModal.style.display = 'flex';
        termsModal.animate([{opacity:0},{opacity:1}], {duration:300, fill:'forwards'});
        termsModal.focus();
      }
      function closeTermsModal() {
        const anim = termsModal.animate([{opacity:1},{opacity:0}], {duration:300, fill:'forwards'});
        anim.onfinish = () => {
          termsModal.classList.remove('show');
          termsModal.style.display = 'none';
        }
      }
      termsCloseBtn.addEventListener('click', closeTermsModal);
      termsModal.addEventListener('click', e => {
        if (e.target === termsModal) closeTermsModal();
      });
      document.addEventListener('keydown', e => {
        if (e.key === 'Escape' && termsModal.style.display === 'flex') closeTermsModal();
      });

      // Form validation
      function validateForm() {
        const formData = new FormData(joinForm);
        const requiredFields = ['fullName', 'email', 'phone', 'country', 'grade', 'institution', 'heardFrom'];
        for (const field of requiredFields) {
          if (!formData.get(field) || !formData.get(field).trim()) {
            submitBtn.disabled = true;
            return;
          }
        }
        const roles = formData.getAll('roles');
        if (roles.length === 0) {
          submitBtn.disabled = true;
          return;
        }
        if (!termsCheck.checked) {
          submitBtn.disabled = true;
          return;
        }
        submitBtn.disabled = false;
      }
      joinForm.addEventListener('input', validateForm);
      termsCheck.addEventListener('change', validateForm);

      // Form submit
      joinForm.addEventListener('submit', e => {
        e.preventDefault();
        submitBtn.disabled = true;
        submitBtn.textContent = "Submitting...";
        const formData = new FormData(joinForm);
        const data = {};
        formData.forEach((v,k) => {
          if(k==='roles') {
            if(!data.roles) data.roles = [];
            data.roles.push(v);
          } else {
            data[k] = v.trim();
          }
        });
        if(!data.roles) data.roles = [];

        // Delay to simulate submission & show thanks
        setTimeout(() => {
          thankYouMsg.style.display = 'block';
          downloadBtn.style.display = 'inline-block';
          thankYouMsg.scrollIntoView({behavior:'smooth'});
          [...joinForm.elements].forEach(el => el.disabled = true);
          submitBtn.textContent = "Submitted";
          joinForm._submittedData = data;
        }, 650);
      });













      downloadBtn.addEventListener('click', () => {
  try {
    const data = joinForm._submittedData;
    if (!data) {
      alert('No submission data found.');
      return; // stop here
    }

    const doc = new jsPDF({
      unit: 'pt',
      format: 'a4'
    });

    const pageWidth = doc.internal.pageSize.getWidth();
    const pageHeight = doc.internal.pageSize.getHeight();

    // Background pattern: subtle diagonal dots
    const patternSpacing = 22;
    doc.setFillColor(245, 245, 245);
    for (let x = 0; x < pageWidth; x += patternSpacing) {
      for (let y = 0; y < pageHeight; y += patternSpacing) {
        if (((x / patternSpacing + y / patternSpacing) % 2) === 0) {
          doc.circle(x + 5, y + 5, 0.9, 'F');
        }
      }
    }

    // Decorative border with thick lines and rounded arcs
    const margin = 35;
    const borderColor = [10, 90, 180];
    doc.setDrawColor(...borderColor);
    doc.setLineWidth(3);
    doc.rect(margin, margin, pageWidth - 2 * margin, pageHeight - 2 * margin);
    const arcRadius = 20;
    doc.setLineWidth(4);
    doc.arc(margin + arcRadius, margin + arcRadius, arcRadius, 180, 270);
    doc.arc(pageWidth - margin - arcRadius, margin + arcRadius, arcRadius, 270, 360);
    doc.arc(margin + arcRadius, pageHeight - margin - arcRadius, arcRadius, 90, 180);
    doc.arc(pageWidth - margin - arcRadius, pageHeight - margin - arcRadius, arcRadius, 0, 90);

    doc.setTextColor(...borderColor);
    doc.setFontSize(28);
    doc.setFont('helvetica', 'bold');
    doc.text('MergeScholars Application Form', pageWidth / 2, 85, { align: 'center' });

    doc.setFontSize(16);
    doc.setFont('helvetica', 'italic');
    doc.setTextColor(90);
    doc.text('Taking contribution to giving contribution', pageWidth / 2, 110, { align: 'center' });

    doc.setDrawColor(...borderColor);
    doc.setLineWidth(1.5);
    doc.line(margin + 15, 120, pageWidth - margin - 15, 120);

    let y = 150;
    const lineHeight = 22;
    doc.setFontSize(13);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(40);

    function drawField(label, value) {
      doc.setFont(undefined, 'bold');
      doc.text(label + ':', margin + 30, y);
      doc.setFont(undefined, 'normal');
      const splitText = doc.splitTextToSize(value || '-', pageWidth - 2 * margin - 150);
      doc.text(splitText, margin + 140, y);
      y += lineHeight * splitText.length;
    }

    drawField('Full Name', data.fullName);
    drawField('Email', data.email);
    drawField('Phone', data.phone);
    if (data.country) drawField('Country', data.country);
    if (data.grade) drawField('Grade/Class', data.grade);
    if (data.institution) drawField('Institution', data.institution);
    if (data.roles) drawField('Roles Applied For', Array.isArray(data.roles) ? data.roles.join(', ') : data.roles);
    if (data.roles && data.roles.some(r => ['Volunteer', 'Contributor', 'Promoter'].includes(r)) && data.skills?.trim()) {
      drawField('Skills', data.skills);
    }
    drawField('Heard About MergeScholars', data.heardFrom);

    const now = new Date();
    const dateStr = now.toLocaleDateString('en-GB', { year: 'numeric', month: 'short', day: 'numeric' });
    y += 15;
    doc.setFont(undefined, 'italic');
    doc.setTextColor(120);
    doc.text(`Submission Date: ${dateStr}`, margin + 30, y);

    const safeName = (data.fullName || 'Application').replace(/\s+/g, '_').replace(/[^\w\-]/g, '');
    const fileName = `${safeName}_Submission_${now.getFullYear()}-${(now.getMonth() + 1)
      .toString()
      .padStart(2, '0')}-${now.getDate().toString().padStart(2, '0')}.pdf`;

    // Force download
    doc.save(fileName);

  } catch (err) {
    console.error('Error generating PDF:', err);
    alert('Failed to generate PDF. There is an issue in our Server. Sorry for the inconvenience ');
  }
});








      // Initial skills box update
      updateSkillsBox();

      // Detect device and align boxes
      function alignForDevice() {
        if(window.innerWidth < 720) {
          // Mobile device - center align all text inputs labels etc (default)
          // Form is already responsive with flex column
        } else {
          // Desktop - keep left align, maybe add max widths or grid if needed
        }
      }
      window.addEventListener('resize', alignForDevice);
      alignForDevice();
    })();
  </script>
</body>
</html>

